function shuffle(o){for(var j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);return o}function preload(font){for(var first="A",last="Z",i=first.charCodeAt(0);i<=last.charCodeAt(0);i++){var image=new Image;image.src=font+"/"+String.fromCharCode(i)+".jpg"}}function onSubmit(){var text=document.getElementById("message").value;text=text.toUpperCase();for(var container=document.getElementById("letters"),skip=0,i=0;i<currentText.length;i++)currentText[i]!=text[i]&&(skip=i);(skip<=currentText.length||text.length<currentText)&&(container.innerHTML="",skip=0);for(var i=0;i<text.length;i++)if(!(skip>i)){var character=text.charAt(i),regexp=/[a-zA-Z ]/;if(regexp.test(character)){switch(character){case" ":character="SPACE"}var src=font.url+"/"+character+".jpg",image=new Image;image.src=src,image.onload=function(){resizeImages(),resize()},container.appendChild(image)}}resizeImages(),resize(),currentText=text,setHash()}function resize(){for(var container=document.getElementById("letters"),w=0,i=0;i<container.childNodes.length;i++){var node=container.childNodes[i];w+=node.offsetWidth}container.style.width=w+"px"}function metadata(){document.title=font.name;var author=document.getElementById("author");author.innerHTML=font.author;var body=document.getElementById("body");body.setAttribute("class",font.color)}function onSelect(node){font=fonts[node.value],onSubmit(),metadata(),document.getElementById("message").focus()}function setHash(){var text=document.getElementById("message").value;text&&(window.location.hash=font.url+"/"+Url.encode(text),ga("send","show",font.url,text,{page:"/"+window.location.hash}))}function updateFromHash(){if(""!=window.location.hash){var parts=window.location.hash.split("/",2);if(parts[0]&&parts[1]){var f=parts[0],t=parts[1];f=f.substr(1,f.length-1),document.getElementById("message").value=Url.decode(t);var found=findFontByUrl(f);found&&(font=found)}}}function findFontByUrl(url){for(var i in fonts)if(fonts[i].url==url)return fonts[i];return!1}function downloadText(){if(!isCanvasSupported())return void alert("Downloading not supported. Update to modern browser with CANVAS support.");var m=document.getElementById("message").value,letters=document.getElementById("letters"),images=document.getElementById("letters").childNodes;canvasMergeImages(images,letters.offsetWidth-10,letters.offsetHeight-5,function(jpeg){document.getElementById("download_button").setAttribute("href",jpeg),document.getElementById("download_button").setAttribute("download",m+".jpg")})}function isCanvasSupported(){var elem=document.createElement("canvas");return!(!elem.getContext||!elem.getContext("2d"))}function canvasMergeImages(files,width,height,completed){var canvas=document.createElement("canvas");canvas.width=width,canvas.height=height;var ctx=canvas.getContext("2d"),x=0;for(var i in files){var image=files[i];"undefined"!=typeof image.src&&(ctx.drawImage(image,x,0,image.width,image.height),x+=image.width)}var output=canvas.toDataURL("image/jpeg",1);completed(output)}var fonts=[{name:"Recycle font",url:"recycle",author:'<a href="http://www.vaclav-mach.cz/">Václav Mach</a>',color:"light"},{name:"Bike type",url:"bike",author:'Michal Fojt, Lenka Horáková, <a href="http://mkj.is">Matěj Kašpar Jirásek</a>',color:"dark"},{name:"Duck type",url:"duck",author:'Michal Fojt, Lenka Horáková, <a href="http://mkj.is">Matěj Kašpar Jirásek</a>',color:"dark"},{name:"Králíky square",url:"square",author:"Tomáš Kácel",color:"dark"},{name:"Klam font",url:"klam",author:"Petr Vacek",color:"dark"},{name:"It Socks",url:"it-socks",author:"Gabriel Ádám",color:"light"},{name:"Walk This Way",url:"walk-this-way",author:"Gabriel Ádám",color:"dark"},{name:"Mouka Type",url:"mouka",author:"Jana Ludvíková",color:"light"},{name:"Káva Type",url:"kava",author:"Martina Marešová",color:"dark"},{name:"Maru Type",url:"maru",author:"Marie Lukášová",color:"dark"},{name:"Alergie Font",url:"alergie",author:"Richard Záň",color:"light"},{name:"Strawberdose Font",url:"strawberdose",author:"Patrik Slamka, Martin Havlíček",color:"light"},{name:"Towel Type",url:"towel",author:"Jakub Špiřík, Martina Krasnayová",color:"light"},{name:"Huge Font",url:"huge",author:"Jiří Gerat",color:"dark"},{name:"Mark Me Font",url:"mark-me",author:"Andrea Mužíková",color:"dark"},{name:"Money Font",url:"money",author:"Ema Šturalová",color:"light"},{name:"Alone Type",url:"alone",author:"Tomáš Kácel",color:"light"},{name:"NE Font",url:"ne",author:"Dominika Baníková, Jiří Gerat, Anna Kiliánová, Henrik Lauko",color:"dark"},{name:"Lampa Type",url:"lampa",author:"Jiří Starý",color:"dark"},{name:"Eat It",url:"eat-it",author:"Martina Krasnayová, Jakub Špiřík, Gabriela Véghová",color:"light"}],currentText="";fonts=shuffle(fonts);var font=fonts[0];preload(font.url),window.onload=function(){var select=document.getElementById("font");select.innerHTML="<option>Choose your font...</option>";for(var i in fonts){var option='<option value="'+i+'">'+fonts[i].name+"</option>";select.innerHTML+=option}document.getElementById("message").setAttribute("placeholder","WRITE SOMETHING!"),updateFromHash(),onSubmit(),metadata(),resizeImages(),resize(),window.onresize=resizeImages,document.getElementById("message").removeAttribute("disabled"),document.getElementById("font").removeAttribute("disabled"),document.getElementById("download_button").innerHTML="Download as JPEG";for(var i in fonts){var f=fonts[i];if(f.url==font.url){select.value=i;break}}};var resizeImages=function(){for(var images=document.getElementsByTagName("img"),height=document.documentElement.clientHeight,i=0;i<images.length;i++){var image=images[i],ratio=image.width/image.height;if(!isNaN(ratio)){var width=height*ratio;image.style.height=height+"px",image.style.width=width+"px"}}},Url={encode:function(string){return string?escape(this._utf8_encode(string)).replace("+","%2B"):""},decode:function(string){return this._utf8_decode(unescape(string))},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);128>c?utftext+=String.fromCharCode(c):c>127&&2048>c?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext},_utf8_decode:function(utftext){for(var string="",i=0,c=c1=c2=0;i<utftext.length;)c=utftext.charCodeAt(i),128>c?(string+=String.fromCharCode(c),i++):c>191&&224>c?(c2=utftext.charCodeAt(i+1),string+=String.fromCharCode((31&c)<<6|63&c2),i+=2):(c2=utftext.charCodeAt(i+1),c3=utftext.charCodeAt(i+2),string+=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),i+=3);return string}};